" è®¾ç½®leaderé”®
let mapleader = "\<space>"
" open hightlight"
syntax on
"è®¾ç½®æœç´¢é«˜äº®"
set hlsearch
set incsearch
"è®¾ç½®å¿½ç•¥å¤§å°å†™æœç´¢ï¼Œé»˜è®¤ä¸å¼€å¯"
set ignorecase
set smartcase
"å¿½ç•¥swapfileæ–‡ä»¶"
set noswapfile
"æ”¹é”®"
noremap ; :
map s <nop>
map S :w<CR>
map Q :q<CR>
map R :source $MYVIMRC<CR>
"æ‰“å¼€è¡Œå·"
set number
set relativenumber
set wrap
set cursorline
set wildmenu
set showcmd
set encoding=UTF-8
set mouse=a
"å°†ç¼©è¿›è®¾ç½®ä¸ºç©ºæ ¼
let &t_ut=''
set expandtab
set tabstop=4
set shiftwidth=4
set softtabstop=4
"æ¸²æŸ“tabå’Œç©ºæ ¼
set listchars=tab:â–¸\ ,trail:â–«
"å¼€å¯é€€æ ¼æ¢è¡Œ
set backspace=indent,eol,start
"å¼€å¯ä»£ç æŠ˜å 
set foldmethod=indent
set foldlevel=99
"è®¾ç½®è‡ªåŠ¨ç¼©è¿›
set autoindent
"å¤åˆ¶ç²˜è´´åˆ°å‰ªè´´æ¿
vnoremap <leader>y "+y
nmap <leader>p "+p
"undotree
map <F5> :UndotreeToggle<CR>
"NERDTreeToggle
map ff :NERDTreeToggle<CR> 


"ariline
set ambiwidth=double                    " è®¾ç½®ä¸ºåŒå­—å®½æ˜¾ç¤ºï¼Œå¦åˆ™æ— æ³•å®Œæ•´æ˜¾ç¤ºå¦‚:â˜†
let g:airline_theme='bubblegum'		"Airlineä¸»é¢˜
let g:airline_powerline_fonts = 1
" å¼€å¯tabline
let g:airline#extensions#tabline#enabled = 1      "tablineä¸­å½“å‰bufferä¸¤ç«¯çš„åˆ†éš”å­—ç¬¦
let g:airline#extensions#tabline#left_sep = ' '   "tablineä¸­æœªæ¿€æ´»bufferä¸¤ç«¯çš„åˆ†éš”å­—ç¬¦
let g:airline#extensions#tabline#left_alt_sep = '|'      "tablineä¸­bufferæ˜¾ç¤ºç¼–å·
let g:airline#extensions#tabline#buffer_nr_show = 1      
" æ˜ å°„åˆ‡æ¢bufferçš„é”®ä½
nnoremap [b :bp<CR>
nnoremap ]b :bn<CR>

"è®¾ç½®å­—ä½“
set guifont=Powerline_Consolas:h12:cANSI:qDRAFT

"å¤šè¯­è¨€æŸ¥é”™ALE
"å§‹ç»ˆå¼€å¯æ ‡å¿—åˆ—
let g:ale_sign_column_always = 1
let g:ale_set_highlights = 0
"è‡ªå®šä¹‰errorå’Œwarningå›¾æ ‡
let g:ale_sign_error = 'âŒ'
let g:ale_sign_warning = 'ğŸ”°'
"åœ¨vimè‡ªå¸¦çš„çŠ¶æ€æ ä¸­æ•´åˆale
let g:ale_statusline_format = ['âœ— %d', 'âš¡ %d', 'âœ” OK']
"æ˜¾ç¤ºLinteråç§°,å‡ºé”™æˆ–è­¦å‘Šç­‰ç›¸å…³ä¿¡æ¯
let g:ale_echo_msg_error_str = 'E'
let g:ale_echo_msg_warning_str = 'W'
let g:ale_echo_msg_format = '[%linter%] %s [%severity%]'
"æ™®é€šæ¨¡å¼ä¸‹ï¼Œspå‰å¾€ä¸Šä¸€ä¸ªé”™è¯¯æˆ–è­¦å‘Šï¼Œsnå‰å¾€ä¸‹ä¸€ä¸ªé”™è¯¯æˆ–è­¦å‘Š
nmap sp <Plug>(ale_previous_wrap)
nmap sn <Plug>(ale_next_wrap)
"<Leader>sè§¦å‘/å…³é—­è¯­æ³•æ£€æŸ¥
nmap <leader>s :ALEToggle<CR>
"<Leader>dæŸ¥çœ‹é”™è¯¯æˆ–è­¦å‘Šçš„è¯¦ç»†ä¿¡æ¯
nmap <leader>d :ALEDetail<CR>
"set statusline=%F%m%r%h%w\ [FORMAT=%{&ff}]\ [TYPE=%Y]\ [POS=%l,%v][%p%%]\ %{strftime(\"%d/%m/%y\ -\ %H:%M\")}\ %{ALEGetStatusLine()}
"cpp NOT C++
let g:ale_linters = {
\   'c++': ['clang'],
\   'c': ['gcc'],
\   'python': ['pylint'],
\}

"ä»£ç è‡ªåŠ¨æ³¨é‡Š
map <C-m> <leader>cc
map <A-m> <leader>cu
unmap <CR>

"å½©è™¹æ‹¬å·
" 1. vscode defult 2. author defult 3. vscode show
"	\	'guifgs': ['#B21212', '#1B9CED','#FFFC00'],
"	\	'guifgs': ['royalblue3', 'darkorange3', 'seagreen3', 'firebrick'],
"	\	'guifgs': ['#C186BF', '#268EDB','#F79318'],
	let g:rainbow_conf = {
	\	'guifgs': ['#C186BF', '#268EDB','#F79318'],
	\	'ctermfgs': ['lightblue', 'lightyellow', 'lightcyan', 'lightmagenta'],
	\	'operators': '_,_',
	\	'parentheses': ['start=/(/ end=/)/ fold', 'start=/\[/ end=/\]/ fold', 'start=/{/ end=/}/ fold'],
	\	'separately': {
	\		'*': {},
	\		'tex': {
	\			'parentheses': ['start=/(/ end=/)/', 'start=/\[/ end=/\]/'],
	\		},
	\		'lisp': {
	\			'guifgs': ['royalblue3', 'darkorange3', 'seagreen3', 'firebrick', 'darkorchid3'],
	\		},
	\		'vim': {
	\			'parentheses': ['start=/(/ end=/)/', 'start=/\[/ end=/\]/', 'start=/{/ end=/}/ fold', 'start=/(/ end=/)/ containedin=vimFuncBody', 'start=/\[/ end=/\]/ containedin=vimFuncBody', 'start=/{/ end=/}/ fold containedin=vimFuncBody'],
	\		},
	\		'html': {
	\			'parentheses': ['start=/\v\<((area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)[ >])@!\z([-_:a-zA-Z0-9]+)(\s+[-_:a-zA-Z0-9]+(\=("[^"]*"|'."'".'[^'."'".']*'."'".'|[^ '."'".'"><=`]*))?)*\>/ end=#</\z1># fold'],
	\		},
	\		'css': 0,
	\	}
	\}
let g:rainbow_active = 1

"è‡ªå®šä¹‰å¼€å§‹èœå•
let g:startify_custom_header = [
            \ '+------------------------------+',
            \ '|                              |',
            \ '|    Still waters run deep!    |',
            \ '|                              |',
            \ '+----------------+-------------+',
            \]
let g:startify_custom_footer = [
            \ '+------------------------------+',
            \ '|     Keep an open mind!       |',
            \ '+----------------+-------------+',
            \]
let g:startify_files_number = 5
let g:startify_custom_indices = map(range(1,100), 'string(v:val)')

"markdown
let g:vim_markdown_math = 1
let g:vmt_auto_update_on_save = 0
let g:mkdp_markdown_css=''
let g:mkdp_browser = 'firefox'
let g:table_mode_corner = '|'
let g:table_mode_border=0
let g:table_mode_fillchar=' '
"è¡¨æ ¼è‡ªåŠ¨è¡¥å…¨
function! s:isAtStartOfLine(mapping)
  let text_before_cursor = getline('.')[0 : col('.')-1]
  let mapping_pattern = '\V' . escape(a:mapping, '\')
  let comment_pattern = '\V' . escape(substitute(&l:commentstring, '%s.*$', '', ''), '\')
  return (text_before_cursor =~? '^' . ('\v(' . comment_pattern . '\v)?') . '\s*\v' . mapping_pattern . '\v$')
endfunction

inoreabbrev <expr> <bar><bar>
          \ <SID>isAtStartOfLine('\|\|') ?
          \ '<c-o>:TableModeEnable<cr><bar><space><bar><left><left>' : '<bar><bar>'
inoreabbrev <expr> __
          \ <SID>isAtStartOfLine('__') ?
          \ '<c-o>:silent! TableModeDisable<cr>' : '__'

"ç®—æ³•Algorithm
set cindent
map <F5> :call Run()<CR>
func! Run()
	exec "w"
	exec "!g++ -Wall % -o %<"
	exec "!./%<"
endfunc

call plug#begin('~/.vim/plugged')
Plug 'Raimondi/delimitMate'
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'
Plug 'mhinz/vim-startify'
Plug 'luochen1990/rainbow'
Plug 'preservim/nerdcommenter'
Plug 'dense-analysis/ale'
Plug 'preservim/nerdtree'
Plug 'mbbill/undotree'
Plug 'connorholyday/vim-snazzy'
Plug 'neoclide/coc.nvim', {'branch': 'release'}
"ä»è¿™å¾€ä¸‹éƒ½æ˜¯ä¸markdownç›¸å…³
Plug 'dhruvasagar/vim-table-mode'
Plug 'godlygeek/tabular'
Plug 'mzlogin/vim-markdown-toc'
Plug 'plasticboy/vim-markdown'
Plug 'iamcco/markdown-preview.nvim', { 'do': { -> mkdp#util#install() }, 'for': ['markdown', 'vim-plug']}
Plug 'ferrine/md-img-paste.vim'
Plug 'chemzqm/wxapp.vim'
call plug#end()
"ä½¿ç”¨snazzyçš„config"
color snazzy
"é»˜è®¤èƒŒæ™¯é€æ˜"
"let g:SnazzyTransparent = 1

"coc è‡ªåŠ¨è¡¥å…¨é…ç½®
" Use tab for trigger completion with characters ahead and navigate
" NOTE: There's always complete item selected by default, you may want to enable
" no select by `"suggest.noselect": true` in your configuration file
" NOTE: Use command ':verbose imap <tab>' to make sure tab is not mapped by
" other plugin before putting this into your config
inoremap <silent><expr> <TAB>
      \ coc#pum#visible() ? coc#pum#next(1) :
      \ CheckBackspace() ? "\<Tab>" :
      \ coc#refresh()
inoremap <expr><S-TAB> coc#pum#visible() ? coc#pum#prev(1) : "\<C-h>"

" Make <CR> to accept selected completion item or notify coc.nvim to format
" <C-g>u breaks current undo, please make your own choice
inoremap <silent><expr> <CR> coc#pum#visible() ? coc#pum#confirm()
                              \: "\<C-g>u\<CR>\<c-r>=coc#on_enter()\<CR>"

function! CheckBackspace() abort
  let col = col('.') - 1
  return !col || getline('.')[col - 1]  =~# '\s'
endfunction
